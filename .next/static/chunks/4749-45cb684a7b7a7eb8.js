"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4749],{54749:function(e,i,t){t.r(i),t.d(i,{default:function(){return P}});var n=t(57437);t(2265);var r=t(59077),o=t(74275),d=t.n(o),s=t(35843),a=t(44551),l=t(85269),c=t(96507),u=t(38939),p=t(65984),h=t(13457),x=t(21677),j=t(67248),m=t(5096),v=t(60529),Z=t(27400),g=t(45099),y=t(75483),b=t(37749),w=t(24033),f=t(35691),C=t(5925),T=t(52072);let q=(0,s.ZP)(l.Z)(e=>{let{theme:i}=e;return{...i.typography.subtitle2,color:i.palette.text.secondary,marginBottom:i.spacing(1),lineHeight:2.5}});function P(e){var i;let{data:t,isLoading:o}=e,d=(0,w.useRouter)(),{mutate:s,isLoading:l}=(0,r.useMutation)(t?"update":"new",t?b.updateCouponCode:b.addCouponCode,{...t&&{enabled:!!t},retry:!1,onSuccess:e=>{C.ZP.success(e.message),d.push("/dashboard/coupon-codes")},onError:e=>{C.ZP.error(e.message)}}),P=f.Ry().shape({name:f.Z_().required("Name is required"),description:f.Z_().required("Description is required"),code:f.Z_().required("Cover is required").matches(/^(\S+$)/g,"Space is not allowed"),discount:f.Rx().required("Discount is required"),expire:f.hT().when("eventStartDate",(e,i)=>i.min(new Date,"Expiry date can't be past date."))}),_=(0,T.TA)({initialValues:{name:(null==t?void 0:t.name)||"",code:(null==t?void 0:t.code)||"",type:(null==t?void 0:t.type)||"fixed",discount:(null==t?void 0:t.discount)||"",expire:(null==t?void 0:null===(i=t.expire)||void 0===i?void 0:i.split("T")[0])||"",description:(null==t?void 0:t.description)||""},enableReinitialize:!0,validationSchema:P,onSubmit:async e=>{let{...i}=e;try{s({...i,...t&&{currentId:null==t?void 0:t._id}})}catch(e){console.error(e)}}}),{errors:k,values:D,touched:F,handleSubmit:S,setFieldValue:E,getFieldProps:W}=_;return(0,n.jsx)(c.Z,{position:"relative",children:(0,n.jsx)(T.Hy,{value:_,children:(0,n.jsx)(T.l0,{noValidate:!0,autoComplete:"off",onSubmit:S,children:(0,n.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(u.ZP,{item:!0,xs:12,md:8,children:(0,n.jsx)(p.Z,{sx:{p:3},children:(0,n.jsxs)(h.Z,{spacing:3,children:[(0,n.jsxs)("div",{children:[o?(0,n.jsx)(x.Z,{variant:"text",width:140}):(0,n.jsxs)(q,{component:"label",htmlFor:"name",children:[" ","Name"," "]}),o?(0,n.jsx)(x.Z,{variant:"rectangular",width:"100%",height:56}):(0,n.jsx)(j.Z,{id:"name",fullWidth:!0,...W("name"),error:!!(F.name&&k.name),helperText:F.name&&k.name})]}),(0,n.jsxs)("div",{children:[o?(0,n.jsx)(x.Z,{variant:"text",width:100}):(0,n.jsx)(q,{component:"label",htmlFor:"coupen-code",children:"Coupon code"}),o?(0,n.jsx)(x.Z,{variant:"rectangular",width:"100%",height:56}):(0,n.jsx)(j.Z,{id:"coupen-code",fullWidth:!0,...W("code"),error:!!(F.code&&k.code),helperText:F.code&&k.code})]}),(0,n.jsx)("div",{children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(q,{component:"label",htmlFor:"discount-type",children:"Discount type"}),(0,n.jsxs)(v.Z,{row:!0,name:"row-radio-buttons-group",value:D.type,onChange:e=>E("type",e.target.value),children:[(0,n.jsx)(Z.Z,{value:"fixed",control:(0,n.jsx)(g.Z,{}),label:"Fixed amount"}),(0,n.jsx)(Z.Z,{value:"percent",control:(0,n.jsx)(g.Z,{}),label:"Percentage"})]})]})}),(0,n.jsxs)("div",{children:[o?(0,n.jsx)(x.Z,{variant:"text",width:70}):(0,n.jsxs)(q,{component:"label",htmlFor:"discount",children:[" ","Discount"]}),o?(0,n.jsx)(x.Z,{variant:"rectangular",width:"100%",height:56}):(0,n.jsx)(j.Z,{id:"discount",fullWidth:!0,...W("discount"),error:!!(F.discount&&k.discount),helperText:F.discount&&k.discount,InputProps:{endAdornment:(0,n.jsx)(y.Z,{position:"end",children:"fixed"===D.type?"$":"%"})}})]})]})})}),(0,n.jsx)(u.ZP,{item:!0,xs:12,md:4,children:(0,n.jsx)("div",{style:{position:"-webkit-sticky",position:"sticky",top:0},children:(0,n.jsxs)(h.Z,{spacing:3,children:[(0,n.jsx)(p.Z,{sx:{p:3},children:(0,n.jsxs)(h.Z,{spacing:3,children:[(0,n.jsxs)("div",{children:[o?(0,n.jsx)(x.Z,{variant:"text",width:150}):(0,n.jsxs)(q,{component:"label",htmlFor:"description",children:[" ","Description"," "]}),o?(0,n.jsx)(x.Z,{variant:"rectangular",width:"100%",height:240}):(0,n.jsx)(j.Z,{id:"description",fullWidth:!0,...W("description"),error:!!(F.description&&k.description),helperText:F.description&&k.description,rows:9,multiline:!0})]}),(0,n.jsxs)("div",{children:[o?(0,n.jsx)(x.Z,{variant:"text",width:70}):(0,n.jsxs)(q,{component:"label",htmlFor:"expiry-date",children:[" ","Expiry date"]}),o?(0,n.jsx)(x.Z,{variant:"rectangular",width:"100%",height:56}):(0,n.jsx)(j.Z,{id:"expiry-date",type:"date",fullWidth:!0,...W("expire"),error:!!(F.expire&&k.expire),helperText:F.expire&&k.expire})]})]})}),o?(0,n.jsx)(x.Z,{variant:"rectangular",width:"100%",height:56}):(0,n.jsx)(a.Z,{type:"submit",variant:"contained",size:"large",loading:l,sx:{ml:"auto",mt:3},children:t?"edit coupon code":"create coupon code"})]})})})]})})})})}P.propTypes={data:d().object,isLoading:d().bool}}}]);