"use strict";exports.id=9148,exports.ids=[9148],exports.modules={65943:(e,r,t)=>{var i=t(41769);r.Z=void 0;var o=i(t(33574)),n=t(53854),a=(0,o.default)((0,n.jsx)("path",{d:"M21.02 5H19V2.98c0-.54-.44-.98-.98-.98h-.03c-.55 0-.99.44-.99.98V5h-2.01c-.54 0-.98.44-.99.98v.03c0 .55.44.99.99.99H17v2.01c0 .54.44.99.99.98h.03c.54 0 .98-.44.98-.98V7h2.02c.54 0 .98-.44.98-.98v-.04c0-.54-.44-.98-.98-.98zM16 9.01V8h-1.01c-.53 0-1.03-.21-1.41-.58-.37-.38-.58-.88-.58-1.44 0-.36.1-.69.27-.98H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8.28c-.3.17-.64.28-1.02.28-1.09-.01-1.98-.9-1.98-1.99zM15.96 19H6c-.41 0-.65-.47-.4-.8l1.98-2.63c.21-.28.62-.26.82.02L10 18l2.61-3.48c.2-.26.59-.27.79-.01l2.95 3.68c.26.33.03.81-.39.81z"}),"AddPhotoAlternateRounded");r.Z=a},33574:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return i.createSvgIcon}});var i=t(93336)},59148:(e,r,t)=>{t.r(r),t.d(r,{default:()=>V});var i=t(53854),o=t(4206),n=t(34218),a=t.n(n),s=t(21613),l=t(21703),c=t(38770),d=t(18363),p=t(50477),h=t(43958),u=t(29847),m=t(91494),x=t(90509),j=t(81891),g=t(36065),v=t.n(g),f=t(34324),y=t.n(f),Z=t(20610),b=t(98300),N=t(64022),w=t(65943),z=t(61753),P=t(30082);let F=(0,Z.ZP)("div")(({theme:e})=>({width:144,height:144,margin:"auto",borderRadius:"50%",padding:e.spacing(1),border:`1px dashed ${e.palette.divider}`,position:"reltive"})),R=(0,Z.ZP)("div")({zIndex:0,width:"100%",height:"100%",outline:"none",display:"flex",overflow:"hidden",borderRadius:"50%",position:"relative",alignItems:"center",justifyContent:"center","& > *":{width:"100%",height:"100%"},"&:hover":{cursor:"pointer","& .placeholder":{zIndex:9}}}),S=(0,Z.ZP)("div")(({theme:e})=>({display:"flex",position:"absolute",alignItems:"center",flexDirection:"column",justifyContent:"center",color:e.palette.text.secondary,backgroundColor:e.palette.background.default,transition:e.transitions.create("opacity",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.shorter}),"&:hover":{opacity:.72}}));function A({...e}){let{error:r,file:t,caption:o,sx:n,...a}=e,{getRootProps:s,getInputProps:l,isDragActive:c,isDragReject:d,fileRejections:p}=(0,z.uI)({multiple:!1,...a});return(0,i.jsxs)(i.Fragment,{children:[i.jsx(F,{sx:n,children:(0,i.jsxs)(R,{...s(),sx:{...c&&{opacity:.72},...(d||r)&&{color:"error.main",borderColor:"error.light",bgcolor:"error.lighter"}},children:[i.jsx("input",{...l()}),t&&i.jsx(x.Z,{component:"img",alt:"avatar",src:v()(t)?t:t.preview,sx:{zIndex:8,objectFit:"cover"}}),(0,i.jsxs)(S,{className:"placeholder",sx:{...t&&{opacity:0,color:"common.white",bgcolor:"grey.900","&:hover":{opacity:.72}}},children:[i.jsx(w.Z,{sx:{mb:1}}),i.jsx(h.Z,{variant:"caption",children:t?"Update photo":"Upload photo"})]})]})}),o,p.length>0&&i.jsx(()=>i.jsx(N.Z,{variant:"outlined",sx:{py:1,px:2,my:2,borderColor:"error.light",bgcolor:e=>(0,b.Fq)(e.palette.error.main,.08)},children:p.map(({file:e,errors:r})=>{let{path:t,size:o}=e;return(0,i.jsxs)(x.Z,{sx:{my:1},children:[(0,i.jsxs)(h.Z,{variant:"subtitle2",noWrap:!0,children:[t," - ",(0,P.oe)(o)]}),r.map(e=>(0,i.jsxs)(h.Z,{variant:"caption",component:"p",children:["- ",e.message]},e.code))]},t)})}),{})]})}A.propTypes={error:y().bool,file:y().oneOfType([y().string,y().object]),caption:y().node,sx:y().object};var T=t(90536),_=t(36375),U=t(36391),C=t(29614),L=t(83847),I=t(6715),M=t(92394),W=t(85256),q=t(51018);function V(){let{user:e}=(0,I.v9)(({user:e})=>e),r=(0,q.usePathname)(),t=(0,q.useRouter)(),g=(0,I.I0)(),{data:v,isLoading:f}=(0,o.useQuery)(["user-profile"],()=>_.getProfile(),{onSuccess:({data:e})=>{k(e?.cover?._id||null)}}),[y,Z]=a().useState(!1),{mutate:b,isLoading:N}=(0,o.useMutation)(_.updateProfile,{onSuccess:e=>{g((0,M.R9)(e.data)),W.Am.success("Updated profile")}}),{mutate:w,isLoading:z}=(0,o.useMutation)(_.singleDeleteFile,{onSuccess:()=>{},onError:e=>{W.Am.error(e.response.data.message)}}),P=v?.data||{},[F,R]=a().useState(100),[S,V]=a().useState(!1),[O,k]=a().useState(null),D=(0,n.useCallback)(e=>{R(e)},[R]);console.log(P,"user data");let H=U.Ry().shape({firstName:U.Z_().required("First name required"),lastName:U.Z_().required("Last name required"),phoneNumber:U.Z_().required("Phone required"),gender:U.Z_().required("Gender required")}),E=(0,C.TA)({enableReinitialize:!0,initialValues:{firstName:P?.firstName||"",lastName:P?.lastName||"",email:P?.email||"",photoURL:P?.cover?.url||"",phoneNumber:P?.phone||"",gender:P?.gender||"",about:P?.about||"",file:"",cover:P?.cover,address:P?.address||"",city:P?.city||"",state:P?.state||"",country:P?.country||"Andorra",zip:P?.zip||""},validationSchema:H,onSubmit:async e=>{let r={firstName:e.firstName,lastName:e.lastName,fullName:e.firstName+" "+e.lastName,phone:e.phoneNumber,about:e.about,gender:e.gender,cover:e.cover,address:e.address,city:e.city,state:e.state,country:e.country,zip:e.zip};b(r)}}),{values:G,errors:B,touched:Q,handleSubmit:Y,getFieldProps:$,setFieldValue:J}=E,K=async e=>{let r=e[0];if(r){Z(!0),J("file",r),J("photoURL",{...r,preview:URL.createObjectURL(r)});let e=new FormData;e.append("file",r),e.append("upload_preset","fezrhfpj"),await L.Z.post("https://api.cloudinary.com/v1_1/docjvlprh/image/upload",e,{onUploadProgress:e=>{let{loaded:r,total:t}=e;D(Math.floor(100*r/t))}}).then(({data:e})=>{J("cover",{_id:e.public_id,url:e.secure_url})}).then(()=>{O&&w(O),Z(!1)})}};a().useEffect(()=>{!r.includes("dashboard")&&e?.role.includes("admin")&&(t.push("/dashboard/settings"),(0,W.Am)("Admin cant access this page.",{duration:6e3}))},[]);let{mutate:X}=(0,o.useMutation)(_.resendOTP,{retry:!1,onSuccess:async()=>{W.Am.success("OTP resent"),V(!1),t.push("/auth/verify-otp")},onError:()=>{W.Am.error("Invalid OTP."),V(!1)}});return i.jsx(C.Hy,{value:E,children:i.jsx(C.l0,{autoComplete:"off",noValidate:!0,onSubmit:Y,children:(0,i.jsxs)(l.ZP,{container:!0,spacing:3,mt:3,children:[i.jsx(l.ZP,{item:!0,xs:12,md:4,children:(0,i.jsxs)(c.Z,{sx:{py:11.8,px:3,textAlign:"center"},children:[f||z||y?(0,i.jsxs)(d.Z,{alignItems:"center",children:[i.jsx(p.Z,{variant:"circular",width:142,height:142}),i.jsx(p.Z,{variant:"text",width:150,sx:{mt:1}}),i.jsx(p.Z,{variant:"text",width:150})]}):i.jsx(A,{accept:"image/*",file:G.photoURL,loading:F,maxSize:3145728,onDrop:K,error:!!(Q.photoURL&&B.photoURL),caption:i.jsx(i.Fragment,{children:(0,i.jsxs)(h.Z,{variant:"caption",sx:{mt:2,mx:"auto",display:"block",textAlign:"center",color:"text.secondary",mb:1,position:"relative",svg:{color:"primary.main",position:"absolute",top:"-123px",right:"33%",transform:"translate(24%, -100%)"}},children:[P?.isVerified&&i.jsx(s.vr,{size:24}),"Allowed *.jpeg, *.jpg, *.png, *.gif",i.jsx("br",{})," max size of ",3145728]})})}),i.jsx(u.Z,{error:!0,sx:{px:2,textAlign:"center"},children:Q.photoURL&&B.photoURL}),P?.isVerified?"":i.jsx(j.Z,{loading:S,variant:"text",color:"primary",onClick:()=>{V(!0),X({email:P.email})},children:"Verify Account"})]})}),i.jsx(l.ZP,{item:!0,xs:12,md:8,children:(0,i.jsxs)(c.Z,{sx:{p:3,"& .MuiTypography-root":{marginBottom:"8px !important"}},children:[(0,i.jsxs)(d.Z,{spacing:{xs:2},children:[(0,i.jsxs)(d.Z,{direction:{xs:"column",md:"row"},spacing:2,children:[(0,i.jsxs)(d.Z,{spacing:.5,width:1,children:[i.jsx(h.Z,{variant:"overline",color:"text.primary",htmlFor:"first-name",component:"label",children:"First Name"}),i.jsx(m.Z,{id:"first-name",fullWidth:!0,...$("firstName"),error:!!(Q.firstName&&B.firstName),helperText:Q.firstName&&B.firstName})]}),(0,i.jsxs)(d.Z,{spacing:.5,width:1,children:[i.jsx(h.Z,{variant:"overline",color:"text.primary",htmlFor:"last-name",component:"label",children:"Last name"}),i.jsx(m.Z,{id:"last-name",fullWidth:!0,...$("lastName"),error:!!(Q.lastName&&B.lastName),helperText:Q.lastName&&B.lastName})]})]}),(0,i.jsxs)(d.Z,{direction:{xs:"column",md:"row"},spacing:2,children:[(0,i.jsxs)(d.Z,{spacing:.5,width:1,children:[i.jsx(h.Z,{variant:"overline",color:"text.primary",htmlFor:"phone",component:"label",children:"Phone"}),i.jsx(m.Z,{fullWidth:!0,id:"phone",...$("phoneNumber"),error:!!(Q.phoneNumber&&B.phoneNumber),helperText:Q.phoneNumber&&B.phoneNumber})]}),(0,i.jsxs)(d.Z,{spacing:.5,width:1,children:[i.jsx(h.Z,{variant:"overline",color:"text.primary",htmlFor:"gender",component:"label",children:"Gender"}),(0,i.jsxs)(m.Z,{select:!0,fullWidth:!0,id:"iender",placeholder:"Gender",...$("gender"),SelectProps:{native:!0},error:!!(Q.gender&&B.gender),helperText:Q.gender&&B.gender,children:[i.jsx("option",{value:"male",children:"Male"}),i.jsx("option",{value:"female",children:"Female"})]})]})]}),(0,i.jsxs)(d.Z,{spacing:2,children:[(0,i.jsxs)(d.Z,{spacing:.5,width:1,children:[i.jsx(h.Z,{variant:"overline",color:"text.primary",htmlFor:"address",component:"label",children:"Address"}),i.jsx(m.Z,{id:"address",fullWidth:!0,...$("address"),error:!!(Q.address&&B.address),helperText:Q.address&&B.address})]}),(0,i.jsxs)(d.Z,{spacing:.5,width:1,children:[i.jsx(h.Z,{variant:"overline",color:"text.primary",htmlFor:"country",component:"label",children:"Country"}),i.jsx(m.Z,{id:"country",select:!0,fullWidth:!0,placeholder:"Country",...$("country"),SelectProps:{native:!0},error:!!(Q.country&&B.country),helperText:Q.country&&B.country,children:T.map(e=>i.jsx("option",{value:e.label,children:e.label},e.code))})]}),(0,i.jsxs)(d.Z,{direction:{xs:"column",sm:"row"},spacing:2,children:[(0,i.jsxs)(d.Z,{spacing:.5,width:1,children:[i.jsx(h.Z,{variant:"overline",color:"text.primary",htmlFor:"city",component:"label",children:"Town City"}),i.jsx(m.Z,{id:"city",fullWidth:!0,...$("city"),error:!!(Q.city&&B.city),helperText:Q.city&&B.city})]}),(0,i.jsxs)(d.Z,{spacing:.5,width:1,children:[i.jsx(h.Z,{variant:"overline",color:"text.primary",htmlFor:"state",component:"label",children:"State"}),i.jsx(m.Z,{id:"state",fullWidth:!0,...$("state"),error:!!(Q.state&&B.state),helperText:Q.state&&B.state})]}),(0,i.jsxs)(d.Z,{spacing:.5,width:1,children:[i.jsx(h.Z,{variant:"overline",color:"text.primary",htmlFor:"zip",component:"label",children:"Zip/Postal Code"}),i.jsx(m.Z,{id:"zip",fullWidth:!0,...$("zip"),error:!!(Q.zip&&B.zip),helperText:Q.zip&&B.zip,type:"number"})]})]}),(0,i.jsxs)(d.Z,{spacing:.5,width:1,children:[i.jsx(h.Z,{variant:"overline",color:"text.primary",htmlFor:"about",component:"label",children:"About"}),i.jsx(m.Z,{...$("about"),fullWidth:!0,multiline:!0,minRows:4,maxRows:4,id:"about"})]})]})]}),i.jsx(x.Z,{sx:{mt:3,display:"flex",justifyContent:"flex-end",gap:1},children:i.jsx(j.Z,{type:"submit",variant:"contained",loading:N||z||y,children:"Save"})})]})})]})})})}},30082:(e,r,t)=>{t.d(r,{e_:()=>s,oe:()=>c,v1:()=>l});var i=t(9633),o=t.n(i),n=t(74292),a=t.n(n);function s(e){let r=new Intl.NumberFormat("en-US",{style:"currency",currency:process.env.CURRENCY||"USD"});return r.format(e).slice(0,-1)}function l(e){return o()(a()(e).format("0.00a"),".00","")}function c(e){return a()(e).format("0.0 b")}},41769:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}};